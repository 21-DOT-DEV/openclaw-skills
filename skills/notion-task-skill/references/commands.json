{
  "skill": "notion-task-skill",
  "commands": [
    {
      "name": "doctor",
      "binary": "ntask",
      "description": "Validate environment, credentials, and CLI",
      "output_format": "json",
      "exit_codes": { "0": "All checks pass", "40": "MISCONFIGURED" },
      "destructive": false,
      "idempotent": true,
      "examples": [
        {
          "intent": "Check if the environment is properly configured",
          "command": "ntask doctor",
          "output_format": "json",
          "example_output": { "ok": true, "checks": { "notion_cli": { "found": true }, "db_accessible": true } },
          "exit_code": 0
        }
      ]
    },
    {
      "name": "next",
      "binary": "ntask",
      "description": "Get the highest-priority ready task",
      "output_format": "json",
      "exit_codes": { "0": "Success", "10": "NO_TASKS — no eligible tasks", "30": "API_ERROR", "40": "MISCONFIGURED" },
      "destructive": false,
      "idempotent": true,
      "retry": { "max_attempts": 3, "backoff": "exponential", "initial_delay_ms": 2000 },
      "examples": [
        {
          "intent": "Get the highest-priority ready task",
          "command": "ntask next",
          "output_format": "json",
          "example_output": { "ok": true, "task": { "task_id": "TASK-42", "status": "Ready", "priority": 1 } },
          "exit_code": 0
        }
      ]
    },
    {
      "name": "claim",
      "binary": "ntask",
      "description": "Lock a task for this agent run",
      "parameters": {
        "type": "object",
        "properties": {
          "<task-id>": { "type": "string", "description": "TaskID to claim (positional, e.g. TASK-42)" }
        },
        "required": ["<task-id>"]
      },
      "output_format": "json",
      "exit_codes": {
        "0": "Success — task claimed",
        "20": "CONFLICT — task already claimed by another agent",
        "30": "API_ERROR",
        "40": "MISCONFIGURED"
      },
      "destructive": true,
      "idempotent": false,
      "requires_confirmation": false,
      "capability": "lifecycle",
      "examples": [
        {
          "intent": "Claim a task for this agent run",
          "command": "ntask claim TASK-42",
          "output_format": "json",
          "example_output": { "ok": true, "task": { "status": "In Progress", "lock_token": "uuid-lock-token" } },
          "exit_code": 0
        }
      ]
    },
    {
      "name": "heartbeat",
      "binary": "ntask",
      "description": "Extend the lock lease on a claimed task",
      "parameters": {
        "type": "object",
        "properties": {
          "<task-id>": { "type": "string", "description": "TaskID to heartbeat (positional)" }
        },
        "required": ["<task-id>"]
      },
      "output_format": "json",
      "exit_codes": {
        "0": "Success — lease extended",
        "21": "LOST_LOCK — lock expired or stolen",
        "30": "API_ERROR"
      },
      "destructive": true,
      "idempotent": true,
      "requires_confirmation": false,
      "capability": "lifecycle",
      "examples": [
        {
          "intent": "Extend lock on a claimed task",
          "command": "ntask heartbeat TASK-42",
          "output_format": "json",
          "example_output": { "ok": true, "task": { "page_id": "abc-123", "status": "In Progress" } },
          "exit_code": 0
        }
      ]
    },
    {
      "name": "block",
      "binary": "ntask",
      "description": "Mark a task as Blocked with reason",
      "parameters": {
        "type": "object",
        "properties": {
          "<task-id>": { "type": "string", "description": "TaskID to block (positional)" },
          "--reason": { "type": "string", "description": "Reason for blocking" },
          "--unblock-action": { "type": "string", "description": "What needs to happen to unblock" }
        },
        "required": ["<task-id>", "--reason", "--unblock-action"]
      },
      "output_format": "json",
      "exit_codes": {
        "0": "Success — task blocked",
        "21": "LOST_LOCK",
        "30": "API_ERROR",
        "40": "MISCONFIGURED"
      },
      "destructive": true,
      "idempotent": false,
      "requires_confirmation": false,
      "retry": { "max_attempts": 3, "backoff": "exponential", "initial_delay_ms": 2000 },
      "capability": "lifecycle",
      "examples": [
        {
          "intent": "Block a task with a reason",
          "command": "ntask block TASK-42 --reason \"Waiting on API access\" --unblock-action \"Provision API key\"",
          "output_format": "json",
          "example_output": { "ok": true, "task": { "page_id": "abc-123", "status": "Blocked" } },
          "exit_code": 0
        }
      ]
    },
    {
      "name": "create",
      "binary": "ntask",
      "description": "Create a new task or subtask",
      "parameters": {
        "type": "object",
        "properties": {
          "--title": { "type": "string", "description": "Task title" },
          "--priority": { "type": "integer", "description": "Priority level (1=highest)" },
          "--class": { "type": "string", "description": "Class of service: Expedite, Fixed Date, Standard, Intangible" }
        },
        "required": ["--title"]
      },
      "output_format": "json",
      "exit_codes": {
        "0": "Success — task created",
        "30": "API_ERROR",
        "40": "MISCONFIGURED"
      },
      "destructive": true,
      "idempotent": false,
      "requires_confirmation": true,
      "confirmation_message": "Create task '{--title}' with priority {--priority}?",
      "retry": { "max_attempts": 3, "backoff": "exponential", "initial_delay_ms": 2000 },
      "capability": "management",
      "examples": [
        {
          "intent": "Create a new task",
          "command": "ntask create --title \"Fix login bug\" --priority 2",
          "output_format": "json",
          "example_output": { "ok": true, "task": { "page_id": "new-456", "task_id": "TASK-99", "status": "Backlog", "priority": 2 } },
          "exit_code": 0
        }
      ]
    },
    {
      "name": "list",
      "binary": "ntask",
      "description": "List tasks with optional status filter",
      "parameters": {
        "type": "object",
        "properties": {
          "--status": { "type": "string", "description": "Filter by status (Ready, In Progress, Done, Blocked, etc.)" }
        }
      },
      "output_format": "json",
      "exit_codes": {
        "0": "Success",
        "30": "API_ERROR",
        "40": "MISCONFIGURED"
      },
      "destructive": false,
      "idempotent": true,
      "retry": { "max_attempts": 3, "backoff": "exponential", "initial_delay_ms": 2000 },
      "examples": [
        {
          "intent": "List all tasks with a status filter",
          "command": "ntask list --status 'In Progress'",
          "output_format": "json",
          "example_output": {
            "ok": true,
            "tasks": [
              { "page_id": "abc-123", "task_id": "TASK-42", "status": "In Progress" }
            ]
          },
          "exit_code": 0
        }
      ]
    },
    {
      "name": "get",
      "binary": "ntask",
      "description": "Get full details of a specific task",
      "parameters": {
        "type": "object",
        "properties": {
          "<task-id>": { "type": "string", "description": "TaskID to look up (positional, e.g. TASK-42)" }
        },
        "required": ["<task-id>"]
      },
      "output_format": "json",
      "exit_codes": {
        "0": "Success",
        "30": "API_ERROR",
        "40": "MISCONFIGURED"
      },
      "destructive": false,
      "idempotent": true,
      "retry": { "max_attempts": 3, "backoff": "exponential", "initial_delay_ms": 2000 },
      "examples": [
        {
          "intent": "Get full details of a specific task",
          "command": "ntask get TASK-42",
          "output_format": "json",
          "example_output": { "ok": true, "task": { "task_id": "TASK-42", "status": "In Progress", "priority": 1 } },
          "exit_code": 0
        }
      ]
    },
    {
      "name": "comment",
      "binary": "ntask",
      "description": "Add a comment to a task",
      "parameters": {
        "type": "object",
        "properties": {
          "<task-id>": { "type": "string", "description": "TaskID to comment on (positional)" },
          "--text": { "type": "string", "description": "Comment text" }
        },
        "required": ["<task-id>", "--text"]
      },
      "output_format": "json",
      "exit_codes": {
        "0": "Success",
        "30": "API_ERROR"
      },
      "destructive": true,
      "idempotent": false,
      "requires_confirmation": false,
      "retry": { "max_attempts": 3, "backoff": "exponential", "initial_delay_ms": 2000 },
      "capability": "query",
      "examples": [
        {
          "intent": "Add a progress comment to a task",
          "command": "ntask comment TASK-42 --text \"Completed initial investigation\"",
          "output_format": "json",
          "example_output": {
            "ok": true
          },
          "exit_code": 0
        }
      ]
    },
    {
      "name": "review",
      "binary": "ntask",
      "description": "Move task to Review for human inspection (--summary required)",
      "parameters": {
        "type": "object",
        "properties": {
          "<task-id>": { "type": "string", "description": "TaskID to review (positional)" },
          "--summary": { "type": "string", "description": "Summary of work done (required)" }
        },
        "required": ["<task-id>", "--summary"]
      },
      "output_format": "json",
      "exit_codes": {
        "0": "Success — task moved to Review",
        "21": "LOST_LOCK",
        "30": "API_ERROR",
        "40": "MISCONFIGURED",
        "41": "INCOMPLETE_SUBTASKS — sub-tasks not all complete"
      },
      "destructive": true,
      "idempotent": false,
      "requires_confirmation": true,
      "confirmation_message": "Move task to Review for human inspection?",
      "capability": "lifecycle",
      "examples": [
        {
          "intent": "Submit task for human review",
          "command": "ntask review TASK-42 --summary \"Implemented auth flow with OAuth provider\"",
          "output_format": "json",
          "example_output": { "ok": true, "task": { "page_id": "abc-123", "status": "Review" } },
          "exit_code": 0
        }
      ]
    },
    {
      "name": "approve",
      "binary": "ntask",
      "description": "Approve a reviewed task and mark as Done",
      "parameters": {
        "type": "object",
        "properties": {
          "<task-id>": { "type": "string", "description": "TaskID to approve (e.g. TASK-42)" },
          "--summary": { "type": "string", "description": "Optional approval summary (added as comment)" }
        },
        "required": ["<task-id>"]
      },
      "output_format": "json",
      "exit_codes": {
        "0": "Success — task approved and marked Done",
        "30": "API_ERROR",
        "40": "MISCONFIGURED — task not in Review status"
      },
      "destructive": true,
      "idempotent": false,
      "requires_confirmation": true,
      "confirmation_message": "Approve this task and mark as Done?",
      "capability": "lifecycle",
      "examples": [
        {
          "intent": "Approve a reviewed task (optionally with --summary comment)",
          "command": "ntask approve TASK-42 --summary \"LGTM, clean implementation\"",
          "output_format": "json",
          "example_output": { "ok": true, "task": { "page_id": "abc-123", "task_id": "TASK-42", "status": "Done" } },
          "exit_code": 0
        }
      ]
    },
    {
      "name": "rework",
      "binary": "ntask",
      "description": "Send a reviewed task back for rework",
      "parameters": {
        "type": "object",
        "properties": {
          "<task-id>": { "type": "string", "description": "TaskID to send back (e.g. TASK-42)" },
          "--reason": { "type": "string", "description": "Reason for rework (feedback for the worker)" }
        },
        "required": ["<task-id>", "--reason"]
      },
      "output_format": "json",
      "exit_codes": {
        "0": "Success — task sent back to In Progress",
        "30": "API_ERROR",
        "40": "MISCONFIGURED — task not in Review status"
      },
      "destructive": true,
      "idempotent": false,
      "requires_confirmation": true,
      "confirmation_message": "Send this task back for rework?",
      "capability": "lifecycle",
      "examples": [
        {
          "intent": "Send task back for rework with feedback",
          "command": "ntask rework TASK-42 --reason \"Needs markdown formatting in README\"",
          "output_format": "json",
          "example_output": { "ok": true, "task": { "page_id": "abc-123", "task_id": "TASK-42", "status": "In Progress" } },
          "exit_code": 0
        }
      ]
    },
    {
      "name": "cancel",
      "binary": "ntask",
      "description": "Cancel a task with reason (conditional lock: required from In Progress, lock-free from other statuses)",
      "parameters": {
        "type": "object",
        "properties": {
          "<task-id>": { "type": "string", "description": "TaskID to cancel (positional)" },
          "--reason": { "type": "string", "description": "Cancellation reason" }
        },
        "required": ["<task-id>", "--reason"]
      },
      "output_format": "json",
      "exit_codes": {
        "0": "Success — task cancelled",
        "21": "LOST_LOCK (only from In Progress)",
        "30": "API_ERROR",
        "40": "MISCONFIGURED"
      },
      "destructive": true,
      "idempotent": false,
      "requires_confirmation": true,
      "confirmation_message": "Cancel task? This action cannot be undone.",
      "capability": "lifecycle",
      "examples": [
        {
          "intent": "Cancel a task that is no longer needed",
          "command": "ntask cancel TASK-42 --reason \"Duplicate of TASK-40\"",
          "output_format": "json",
          "example_output": { "ok": true, "task": { "page_id": "abc-123", "status": "Canceled" } },
          "exit_code": 0
        }
      ]
    },
    {
      "name": "update",
      "binary": "ntask",
      "description": "Update task properties (priority, class).",
      "parameters": {
        "type": "object",
        "properties": {
          "<task-id>": { "type": "string", "description": "TaskID to update (positional)" },
          "--priority": { "type": "integer", "description": "New priority (1-3)" },
          "--class": { "type": "string", "description": "Expedite|Fixed Date|Standard|Intangible" }
        },
        "required": ["<task-id>"]
      },
      "output_format": "json",
      "exit_codes": {
        "0": "Success",
        "30": "API_ERROR",
        "40": "MISCONFIGURED"
      },
      "destructive": true,
      "idempotent": true,
      "requires_confirmation": true,
      "confirmation_message": "Update task properties?",
      "retry": { "max_attempts": 3, "backoff": "exponential", "initial_delay_ms": 2000 },
      "capability": "management",
      "examples": [
        {
          "intent": "Update a task's priority",
          "command": "ntask update TASK-42 --priority 1",
          "output_format": "json",
          "example_output": { "ok": true, "task": { "page_id": "abc-123", "priority": 1 } },
          "exit_code": 0
        }
      ]
    },
    {
      "name": "version",
      "binary": "ntask",
      "description": "Print version information",
      "output_format": "json",
      "destructive": false,
      "idempotent": true,
      "examples": [
        {
          "intent": "Check ntask version",
          "command": "ntask version",
          "output_format": "json",
          "example_output": { "ok": true, "version": "0.6.0" },
          "exit_code": 0
        }
      ]
    }
  ]
}
